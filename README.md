# VCF Variant Selection and Matching Scripts

This repository contains two Python scripts for working with VCF files:

1. **select_specific_genotype.py**: Extracts variants that are present only in a given list of genome IDs from a VCF file.
2. **find_markers_from_tab.py**: Matches a set of variants (from select_specific_genotype.py's output table) against one or more VCF files and calculates, **for each genome**, the percentage of these variants that are found.

---

## 1. Select Specific Variants from VCF

**File:** `select_specific_genotype.py`

### Description
This script takes a VCF file and a list of genome identifiers. It selects only the variants that are **exclusively found** in the specified genomes, and not in the others.

### Usage
```bash
python select_specific_genotype.py -i input.vcf -g genome1 genome2 genome3
```

### Arguments
- `-i` : Path to the input VCF file (**required**).
- `-g` : Space-separated list of genome IDs (**required**).

### Output format
The script prints a **tab-separated table** with the following columns:

| Column     | Description                                                                 |
|------------|-----------------------------------------------------------------------------|
| `chr`      | Chromosome name in the reference genome                                     |
| `pos`      | Position in the reference genome                                            |
| `ref`      | Reference allele                                                            |
| `alt`      | Alternative allele(s)                                                       |
| `genotype` | Specific genotype found in the selected group (can be reference or alternate) |

---

### Example

**Input VCF (`cohort.vcf`):**
```
##fileformat=VCFv4.2
#CHROM  POS     ID  REF ALT QUAL    FILTER  INFO    FORMAT  GenomeA GenomeB GenomeC GenomeD
chr1    100     .   A   G   .       .       .       GT      1       1       0       0
chr1    200     .   T   C   .       .       .       GT      0       0       0       1
chr1    300     .   G   A   .       .       .       GT      1       1       1       1
chr1    400     .   C   T   .       .       .       GT      1       1       .       0
```

**Command:**
```bash
python select_specific_genotype.py -i cohort.vcf -g GenomeA GenomeB
```

**Output (`variants.tab`):**
```
chr     pos     ref alt genotype
chr1    100     A   G   G
chr1    400     C   T   T
```

**Interpretation:**
- At position **100**: Genomes A and B both have **G** (alternate allele), others have **A** (reference allele).
- At position **400**: Genomes A and B both have **T** (alternate), Genome D has **C** (reference), Genome C is missing (`.`).

---

## 2. Search Variants in VCF Files

**File:** `find_markers_from_tab.py`

### Description
This script takes:
- A **tab file** generated by Script 1 (list of specific variants)
- One or more VCF files

It checks if the variants in the tab file are present in the VCF(s) and calculates the **percentage of variants from the tab file that are found for each genome**.

### Usage
**Single VCF mode:**
```bash
python find_snps_from_tab.py -i sample.vcf -t variants.tab
```

**Multi-sample VCF mode:**
```bash
python find_snps_from_tab.py -i multi_sample.vcf -t variants.tab -m
```

### Arguments
- `-i` : Path to the input VCF file (or pattern, e.g., `*.vcf`) (**required**).
- `-t` : Tab file from Script 1 (**required**).
- `-m` : Enable multi-sample VCF mode (optional).

---

### Example

**Input `variants.tab` from Script 1:**
```
chr     pos     ref alt genotype
chr1    100     A   G   G
chr1    400     C   T   T
```

**Input multi-sample VCF (`multi_sample.vcf`):**
```
##fileformat=VCFv4.2
#CHROM  POS     ID  REF ALT QUAL    FILTER  INFO    FORMAT  GenomeA GenomeB GenomeC GenomeD
chr1    100     .   A   G   .       .       .       GT      1       1       0       0
chr1    200     .   T   C   .       .       .       GT      0       0       0       1
chr1    400     .   C   T   .       .       .       GT      1       0       0       1
```

**Command:**
```bash
python find_snps_from_tab.py -i multi_sample.vcf -t variants.tab -m
```

**Output:**
```
GenomeA    100.0
GenomeB     50.0
GenomeC      0.0
GenomeD     50.0
```

**Interpretation:**
- **GenomeA** matches **both** variants (100% match).
- **GenomeB** matches only **1/2** variants (50% match).
- **GenomeC** matches **none** (0% match).
- **GenomeD** matches only one variant (50% match).

---

## Example Workflow

**Step 1 — Extract specific variants**
```bash
python select_specific_genotype.py -i cohort.vcf -g GenomeA GenomeB > variants.tab
```

**Step 2 — Search these variants in another VCF**
```bash
python find_snps_from_tab.py -i sample.vcf -t variants.tab
```

**Step 3 — Multi-sample search**
```bash
python find_snps_from_tab.py -i multi_sample.vcf -t variants.tab -m
```

## Citation
coming soon
